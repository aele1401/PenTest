# X-CORP

## Description
X-CORP is a comprehensive penetration testing and incident response project focused on evaluating the security posture of X-CORP's systems. This was done through simulating a Red Team and Blue Team environment, conducting a penetration test with modular, repeatable, and effective security testing processes while leveraging security tools for offensive security. As for defensive security, the task was to test, implement, and monitor alerts generated from SIEM and security tools to respond to security incidents. Also, to conduct network forensics to analyze and report on malicious activity not detected by security tools.

 The project involves various stages of pentesting, including reconnaissance, vulnerability assessment, exploitation, and post-exploitation analysis. It also incorporates the incident response cycle, including preparation, identification, containment, eradication, recovery, and lessons learned. The primary goal is to identify potential vulnerabilities and threats within X-CORP systems, assess their impact, implement new alerts and detections using data analysis, and provide recommendations for mitigating these risks.

## Overview
You are working as a Security Engineer for X-CORP, supporting the SOC infrastructure. The SOC Analysts have noticed some discrepancies with alerting in the Kibana system and the manager has asked the Security Engineering team to investigate. You will start by confirming that newly created Kibana alerts are working, after which you will monitor live traffic on the wire to detect any abnormalities that are not reflected in the alerting system. You are to report back all your findings to both the SOC Manager and the Engineering Manager with appropriate analysis.

## Key Features
* Offensive Security:
    - Reconnaissance: Gathering information on the target system, including network mapping and identifying potential attack vectors.
    - Vulnerability Assessment: Scanning the sytem for know vulnerabilities using industry-standard tools.
    - Exploitation: Attempting to exploit identified vulnerabilities to assess the extent of the security risk.
    - Post-Exploitation: Analyzing the impact of successful exploits, including privilege escalation and data exfiltration.
    - Reporting: Documenting findings, providing a risk assessment, and recommending security improvements.

* Defensive Security:
    - 

## Tools & Technologies
- Network Scanners: Nmap, Netcat, and Nessus
- Exploitation Framework & Tools: Metasploit, John the Ripper, and winPEAS
- Scripting Languages: Python, PHP, and SQL
- Post-Exploitation Tools: Cobalt Strike & Empire
- SIEM Tools: ELK, Elasticsearch Watcher, and Splunk
- Network Forenscis: Wireshark

## Installation

Vagrant was utilized in this project to automate the configuration of virtual machines.

1. Clone repo: Run `git clone https://github.com/aele1401/XCRP_PenTest.git`
2. Navigate to project directory: Run `cd XCRP_PenTest`
3. Update Linux environment: Run `sudo apt-get update && apt-get upgrade`
4. Install the necessary dependencies: Run `pip install -r requirements.txt`

## Network Topology
![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Architecture/XCRP_Topology.PNG)

## Reconnaissance - Describing the Target
Nmap scan identified the following hosts on the network:
|             Hostname          |   IP Address  | Role on Network                        |
|-------------------------------|---------------|----------------------------------------|
| Azure Hyper-V ML-REFVM-684427 | 192.168.1.1   | Host Machine                           |
|             Kali              | 192.168.1.90  | Attack Machine                         |
|           Target 1            | 192.168.1.110 | Target Machine (Hosts WordPress app)   |
|           Target 2            | 192.168.1.115 | Target Machine 2 (Hosts web server)    |
|             ELK               | 192.168.1.100 | ELK Machine (network & system monitor) |
|           Capstone            | 192.168.1.105 | Testing Environment Machine            |

## Vulnerability Assessment

- Assessment uncovered the following vulnerabilities in **Target 1**:
    * Open Ports (CAPEC-300): Ports 22, 80, 111, 137 – 139, and 4444 are open and not monitored. Open ports that are not monitored and controlled can allow an attacker to exploit the services running on those ports, using those ports as points of entry.
        - Impact:
            * SSH with discovered credentials.
            * Access to web servers and DOS attacks.
    * Enumeration & Account Footprinting (CAPEC-575): Web application vulnerability that allows attackers to use brute force techniques to validate users on a network or service.
        - Impact:
            * User enumeration on WordPress app.
            * App susceptible to brute force and DOS attacks.
    * Weak Credentials (CWE-521): Short names, first names, or any simple combinations.
        - Impact:
            * Passwords easy to obtain.
            * Non-complex combinations.
            * User accounts compromised.
    * Misconfigured Security Controls (CWE-284, CAPEC-122, and OWASP Top 10): Improper controls are implemented leaving systems vulnerable to exploits.
        - Impact:
            * Unauthorized access to SQL Database.
            * Data exfiltration.
            * Hash and data dumping.
            * Privilege escalation with sudo and custom scripts.
            * winPEAS privilege escalation.
    * Confidential Data Improperly Secured (CWE-219 & CWE-522): Confidential data, such as users’ personal information and login information, is easily accessible to the public with no security.
        - Impact:
            * Access to authentication logs.
            * "WP-config.php" file accessibl.e
            * Entire WP directory accessible.
    * Brute Force Attack & Insufficient Security Measures (CWE-307 & CWE-49): An attack that consists of systematically checking all possible username and password combinations until the correct one is found.
        - Impact:
            * Improper access controls.
            * Multiple failed login attempts.
            * WordPress app susceptible to brute forcing and password attacks.
    * Directory Path Traversal (CWE-23 & CAPEC-126): Improper access control and filtering allowing access to restricted and hidden directories.
        - Impact:
            * Access to authentication directories.
            * Access to configuration files.
            * Access to web directories.
    * Unsalted Passwords & Insufficient Computational Effort (CWE-916): Salting is adding additional values to hashed passwords, changing the hash value produced.
        - Impact:
            * Usernames and passwords
            * Password cracking (John, Hydra, Hashcat, etc.)
    
    
