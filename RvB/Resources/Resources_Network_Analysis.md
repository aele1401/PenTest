# Network Traffic Analysis

After assessing the targets, a network analysis was conducted on the virutal network. A trojan malware was discovered on the network that was downloaded locally and in>* A private Active Directory domain created to conduct torrenting, avoid detection,>

## Table of Contents
* Time Thieves
* Vulnerable Windows Machines
* Illegal Downloads

### Time Thieves

At least two users on the network have been wasting time on YouTube. It seems these>* They have setup an Active Directory network
* They are constantly streaming videos on YouTube
* Their IP addresses are somewhere in the range 10.6.12.0/24

Inspect the traffic to find the domain name, DC IP, and malware.

* Domain Name: `Fred-n-Ted-DC.frank-n-ted.com`
* Wireshark filter used: `ip.addr==10.6.12.0/24`

![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/Domain_Name.PNG)

* IP Address of Domain Controller: 10.6.6.12.12
* Wireshark filter: `ip.addr==10.6.12.0.24`

![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/Domain_Name.PNG)

* Name of Malware Identified: June11.dll
* Filter: `ip.addr==10.6.12.203 and http.request.method==GET`
* File exported into Kali Machine for further analysis

![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/malware.PNG)

* Uploaded file to "virustotal.com" and malware was classified as a Trojan.

![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/trojan.PNG)

### Vulnerable Windows Machines

The Security Team recieved reports of an infected Windows host machine on the network. They know the following:
* Machines in the network live in the range 172.16.4.0/24.
* The domain "mind-hammer.net" is associated with the infected computer.
* The network has standard gateway and broadcast addresses.

Inspect the traffic to find information about the infected machine, the username of the user infected, IP addresses used in the actual infection traffic.

* Infected Windows machine
	- Host name: `ROTTERDAM-PC`
	- IP Address: `172.16.4.205`
	- MAC Address: `00:59:07:b0:63:a4`
	- Filter: `ip.src==172.16.4.4 and kerberos.CName.String`

	![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/infected_machine.png)

* Username of User
	- Username: `matthjs.devries`
	- Filter: `ip.src==172.16.4.205 and kerberos.CName.String`

	![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/infected_user.png)

* IP Addresses of Actual Infection
	- Infected IP Addresses
		- `172.16.4.205`
		- `185.243.115.84`
		- `166.62.11.64`
	- Device `185.243.115.84` is of interest since it has a lot of POST methods of empty.gifs transmitted with no GET requests.
	- Filter: `ip.addr==172.16.4.205 and ip.addr==185.243.115.84`

	![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/infected_traffic.png)

	- Windows Host Background:

	![Diagram](https://github.com/aele1401/XCRP_PenTest/blob/main/RvB/Images/Network_Forensics/host_background.png)

### Illegal Downloads

IT was informed that some users are torrenting on the network. The Security Team does not forbid the use of torrents for legimate purposes, such as downloading operating systems. However, they have a strict policy against copyright infringement.

IT shared the following about the torrent activity:
	* The machines using torrents live in the range of 10.0.0.0/24 and are clients of an AD domain.
	* The DC of this domain lives at 10.0.0.2 and is named "DogOfTheYear-DC."
	* Th DC is associated with the domain "dogoftheyear.net"

Your task is to isolate torrent traffic and find information on machine with IP address 10.0.0.201. Find MAC address, username, and OS version.

	* MAC address: `00:16:17:18:66:c8`
	* Windows Username: `elmer.blanco`
	* OS Version: `BLANCO-DESKTOP, Windows NT 10x64`
	* Filter: `ip.src==10.0.0.201 and kerberos.CNameString`

	![Diagram](https://github.com/aele1401/XCRP_PenTest/tree/main/RvB/Images/Network_Forensics/device_info.PNG)

	![Diagram](https://github.com/aele1401/XCRP_PenTest/tree/main/RvB/Images/Network_Forensics/device_info2.PNG)

	* Torrent User Downloaded: `Betty_Boop_Rythm_on_the_Reservation.avi.torrent`
	* Filter: `ip.addr==10.0.0.201 and (http.request.uri contains ".torrent")`

	![Diagram](https://github.com/aele1401/XCRP_PenTest/tree/main/RvB/Images/Network_Forensics/torrent.PNG)

 
